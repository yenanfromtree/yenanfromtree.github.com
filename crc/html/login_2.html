<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<script type="text/javascript" src="../js/zepto_1.1.3.js"></script>
		 <style type="text/css">
    	body,html{
    		font-size: 100px;
    		background:white;
    	}
    	.mui-content{
    		background:white;
    		padding-left:0.1rem;
    		padding-right: 0.1rem;
    	}
    	.main_logo{
    		height: 1.17rem;
    	}
    	.hu-btn{
    		width:100%;
    		height: .39rem;
    		margin-top:0.07rem;
    		margin-bottom: 0.07rem;
    	}
    	.login_content input{
    		margin-top:0.07rem;
    		margin-bottom: 0.07rem;
    		border: 1px solid #d7d7d7;
    		border-radius:0.05rem ;
    	} 
    	.login_forget a{
    		text-decoration:underline;
    	}
    	.login_forget p:nth-child(2) a:nth-child(1){
    		text-decoration: none;
    		padding-right:.1rem;
    	}
    	.hu-red-border{
    		border: 1px solid red;
    	}
    </style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		    <h1 class="mui-title">My Information</h1>
		</header>
		<div class="mui-content">
		  <div class="mui-content">
		    <div class="main_logo">
		    </div>
			<div class="login_content">
				<p>
					<input type="text" placeholder="Name" id="name"  />
					<span></span>
				</p>
				<p>
					<input type="text" placeholder="Email" id="input_email" />
					<span></span>
				</p>
				<p>
					<input type="text" placeholder="phone number" id="tel" />
					<span></span>
				</p>
				<p>
					<input type="text" placeholder="country" id="country" />
					<span></span>
				</p>
				<p>
					<button type="button" class="mui-btn mui-btn-blue hu-btn">Submit</button>
				</p>
			</div>
		</div>
		</div>
		
		<script src="../js/mui.min.js"></script>
		<script type="text/javascript">
			mui.init()
			$(function(){
				var state=false;
				var state1=false;
				var state2=false;
				var state3=false;
				$('#input_email').keyup(function(){
					console.log("asdasd")
		            if ($(this).val() ==''){
		            	$(this).addClass("hu-red-border")
		               $(this).next('span').text('邮箱不能为空').css("color","red");
		               state=false;
		            }
		            else{
		                if (/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test($(this).val()) == false) {
		                    $(this).next('span').text('邮箱格式不正确，请重新输入').css("color","red");
		                    $(this).addClass("hu-red-border")
		                     state=false;   
		                }
		                else {
		                    $(this).next('span').text('sucess').css("color","green");
		                    state = true;
		                }
		            }
		            if((state&&state1&&state2&&state3)===false){
		            	$(".hu-btn").prop("disabled",true)
		            }else{
		            	$(".hu-btn").prop("disabled",false)
		            }
		        })
				$('#tel').keyup(function(){
		            if ($(this).val() == ''){
		            	$(this).addClass("hu-red-border")
		               $(this).next('span').text('手机号不能为空').css("color","red");
		               state1=false;
		            }
		            else{
		                if (/^1[34578]\d{9}$/.test($(this).val()) == false) {
		                    $(this).next('span').text('手机号格式不正确，请重新输入').css("color","red");
		                    $(this).addClass("hu-red-border")
		                     state1=false;   
		                }
		                else{
		                    $(this).next('span').text('sucess').css("color","green");
		                    state1 = true;
		                }
		            }
		            if((state&&state1&&state2&&state3)===false){
		            	$(".hu-btn").prop("disabled",true)
		            }else{
		            	$(".hu-btn").prop("disabled",false)
		            }
		        })
				
				$('#name').keyup(function(){
					if($(this).val().length>3){
						 $(this).next('span').text('sucess').css("color","green");
						 state2=true;
					}else{
						 $(this).next('span').text('用户名长多过短').css("color","red");
						 state2=false;
					}
					if((state&&state1&&state2&&state3)===false){
		            	$(".hu-btn").prop("disabled",true)
		            }else{
		            	$(".hu-btn").prop("disabled",false)
		            }
				})
				$('#name').focus(function(){
					if($(this).val().length==0){
						 $(this).next('span').text('用户名长多过短').css("color","red");
						 state2=false;
					}
				})
				$('#country').keyup(function(){
					if($(this).val().length>0){
						 $(this).next('span').text('sucess').css("color","green");
						 state3=true;
					}else{
						 $(this).next('span').text('国家不能为空').css("color","red");
						 state3=false;
					}
					if((state&&state1&&state2&&state3)===false){
		            	$(".hu-btn").prop("disabled",true)
		            }else{
		            	$(".hu-btn").prop("disabled",false)
		            }
				})
				$('#country').focus(function(){
					if($(this).val().length==0){
						 $(this).next('span').text('国家不能为空').css("color","red");
						 state3=false;
					}
				})
				$(".hu-btn").click(function(){
					var a =document.location.href;
					var activityid = a.split('=')[1];
//					var activityid=1110
					var username=$('#name').val();
					var email=$('#input_email').val();
					var phonenumber=$('#tel').val();
					var nationality=$('#country').val();
					$.ajax({
						type:"get",
						url:"http://www.duechina.com/api/index.php/activity/signup?activityid="+activityid+"&username="+username+"&email="+email+"&phonenumber="+phonenumber+"&nationality="+nationality,
						async:true,
						success:function(data){
							if(data.status=="error"){
								console.log(data.msg)
	      						mui.alert(data.msg)
	      					}else if(data.status=="success"){
	      						mui.alert("success")
							}
						}
					});	
				})
			})
		</script>
	</body>

</html>